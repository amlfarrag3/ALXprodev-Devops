#!/bin/bash

POKEMONS=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")
DATA_DIR="pokemon_data"
MAX_RETRIES=3

mkdir -p "$DATA_DIR"

# Function to fetch Pokémon data with retries
fetch_pokemon() {
    name=$1
    retries=0

    while [ $retries -lt $MAX_RETRIES ]; do
        if curl -s "https://pokeapi.co/api/v2/pokemon/${name,,}" -o "$DATA_DIR/${name}.json"; then
            echo "Saved data to $DATA_DIR/${name}.json ✅"
            return
        else
            echo "Retrying $name... attempt $((retries + 1))"
            sleep 2
            retries=$((retries + 1))
        fi
    done

    echo "Failed to fetch $name after $MAX_RETRIES attempts ❌"
}

# Launch each fetch in the background
for name in "${POKEMONS[@]}"; do
    fetch_pokemon "$name" &
done

# Wait for all background jobs to complete
wait

echo "✅ All parallel fetches completed."
